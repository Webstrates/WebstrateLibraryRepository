<!DOCTYPE html>
<html data-protected="all">
    <head>
        <title>Webstrate Library Repository</title>
        <meta charset="UTF-8">
    </head>
    <body>
        <div class="packages">
            <wpm-package id="fast-copy">
                <script id="descriptor-script" type="descriptor">
{
    "description": "fast-copy A blazing fast deep object copier",
    "dependencies": [],
    "assets": [],
    "version": "2.1.3",
    "changelog": {
        "2.1.3": "Initial version"
    },
    "documentationLink": "",
    "license": "MIT"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/fast-copy@2.1.3/dist/fast-copy.min.js");
                    window.fastCopy = window["fast-copy"];
                </script>
            </wpm-package>

            <wpm-package id="cQuery">
                <script id="descriptor-script" type="descriptor">
{
    "description": "cQuery - Lightweight jQuery alternative",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version",
        "1.1": "Fixed liveQuery to work on elements where attributes change, and attribute was part of the live query"
    },
    "documentationLink": "",
    "license": "Apache 2.0"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/cQuery/1.1/caviQuery.min.js");
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/cQuery/1.1/caviQueryPlugins.min.js");
                </script>
            </wpm-package>
            <wpm-package id="UberTracker">
                <script id="descriptor-script" type="descriptor">
{
    "description": "UberTracker",
    "dependencies": ["cQuery", "chrono", "svgjs", "finder"],
    "assets": [],
    "version": "1.0",
    "license": "Apache 2.0",
    "changelog": {
        "1.0": "Initial version"
    }
}

</script>

                <script id="ubertracker-script" type="disabled">
/* global cQuery */

class UberTracker {
    constructor(options) {
        const self = this;

        const defaultOptions = {
            eventPushInterval: 5000,
            apmUpdateInterval: 5000,
            speedUpdateInterval: 5000,
            pointerMoveThrottleInterval: 250,
            trackerUrl: "https://cotinker.projects.cavi.au.dk/ubertracker.php"
        };

        this.options = Object.assign({}, defaultOptions, options);

        this.moveListeners = [];
        this.actionListeners = [];
        this.events = [];

        this.clientDataResolve = null;
        this.clientDataPromise = new Promise((resolve)=>{
            self.clientDataResolve = resolve;
        });

        this.lastPointerMove = 0;

        this.sessionData = null;
        this.clientData = null;

        this.currentlyHoveredTaggedElements = new Set();

        let params = new URLSearchParams(location.search);
        let utrack = params.get("_utrack");

        this.getClientSession(utrack).then((clientData)=>{
            self.clientData = clientData;

            console.log("Got client data:", self.clientData);
            self.clientDataResolve();
        });
    }

    async startTracking() {
        const self = this;

        console.log("Starting UberTracker...");

        this.setupEventListeners();
        this.setupSpeedTrackers();

        await this.clientDataPromise;

        return self.startTrackingSession().then((sessionData)=>{
            self.sessionData = sessionData;
            self.startEventPusher();
            console.log("UberTracker ready:", sessionData);
        });
    }

    startEventPusher() {
        const self = this;
        setInterval(()=>{
            self.postEvents();
        }, this.options.eventPushInterval);
    }

    async doFetch(url, data = null, json = true) {
        let fetchOptions = {
            "method": "GET",
            "credentials": "include",
            "keepalive": true
        }

        if(data != null) {
            //Switch to post method, since we have data
            fetchOptions.method = "POST";

            let formData = new FormData();

            Object.keys(data).forEach((key)=>{
                let value = data[key];
                if(typeof value === "object") {
                    value = JSON.stringify(value);
                }
                formData.append(key, value);
            });

            fetchOptions.body = formData;
        }

        let response = await fetch(url, fetchOptions);

        if(response.status !== 200) {
            let error = await response.text();

            throw new Error("Error in doFetch: "+error);
        }

        let result = "";

        if(json) {
            try {
                result = await response.json();
            } catch(e) {
                console.warn("Error parsing response as json:", e);
                result = {};
            }
        } else {
            result = await response.text();
        }

        return result;
    }

    async ready() {
        return await this.clientDataPromise;
    }

    async getSubsessions(session=false) {
        if (!session){
            await this.clientDataPromise;
            session = this.clientData.session;
        }

        return this.doFetch(this.options.trackerUrl+"?cmd=getSubsessions", {
            session: session
        });
    }

    async getEventsFromSubsession(subsession, options = {}) {
        let data = {
            subsession: subsession
        }

        if(options.types != null) {
            if(Array.isArray(options.types)) {
                data.types = options.types.join(",");
            } else {
                if(typeof options.types === "string") {
                    data.types = options.types;
                } else {
                    console.warn("Unknown options.types variant:", options.types);
                }
            }
        }

        if(options.tags != null) {
            if(Array.isArray(options.tags)) {
                data.tags = options.tags.join(",");
            } else {
                if(typeof options.tags === "string") {
                    data.tags = options.tags;
                } else {
                    console.warn("Unknown options.tags variant:", options.tags);
                }
            }
        }

        if(options.start != null) {
            if(typeof options.start === "number") {
                data.start = options.start;
            } else if(typeof options.start === "string") {
                data.start = chrono.de.parseDate(options.start).getTime();
            } else {
                console.warn("Unknown options.start variant:", options.start);
            }
        }

        if(options.end != null) {
            if(typeof options.end === "number") {
                data.end = options.end;
            } else if(typeof options.end === "string") {
                data.end = chrono.de.parseDate(options.end).getTime();
            } else {
                console.warn("Unknown options.end variant:", options.end);
            }
        }

        return this.doFetch(this.options.trackerUrl+"?cmd=getEvents", data);
    }

    async getStatistics(subsession) {
        return this.doFetch(this.options.trackerUrl+"?cmd=getStatistics", {
            subsession: subsession
        });
    }

    async generateCrossDomainKey(domain) {
        return this.doFetch(this.options.trackerUrl+"?cmd=generateCrossDomainKey", {
            domain: domain
        });
    }

    async getClientSession(utrack = null) {
        return this.doFetch(this.options.trackerUrl+"?cmd=getClientSession", {
            key: utrack
        });
    }

    async startTrackingSession() {
        let data = {
            url: location.href,
            time: Date.now()
        };

        return this.doFetch(this.options.trackerUrl+"?cmd=startTrackingSubsession", {
            "data": data
        });
    }

    postEvents() {
        if(this.events.length === 0) {
            return;
        }

        let data = {
            subsession: this.sessionData.subsession,
            events: JSON.stringify(this.events)
        };

        //Reset events to empty array
        this.events = [];

        return this.doFetch(this.options.trackerUrl+"?cmd=track", data, false);
    }

    setupEventListeners() {
        const self = this;

        console.log("Setting up event listeners...");

        window.addEventListener("focus", (evt)=>{
            self.handleWindowFocus(evt);
        });
        window.addEventListener("blur", (evt)=>{
            self.handleWindowBlur(evt);
        });

        document.body.addEventListener("focusin", (evt)=>{
            self.handleElementFocus(evt)
        }, true);
        document.body.addEventListener("focusout", (evt)=>{
            self.handleElementBlur(evt)
        }, true);
        document.body.addEventListener("click", (evt)=>{
            self.handleElementClick(evt);
        }, true);
        document.body.addEventListener("pointerdown", (evt)=>{
            self.handleElementDown(evt);
        }, true);
        document.body.addEventListener("pointerup", (evt)=>{
            self.handleElementUp(evt);
        }, true);

        document.body.addEventListener("input", (evt)=>{
            self.handleElementInput(evt);
        }, true);

        document.body.addEventListener("keyup", (evt)=>{
            self.handleElementKeyup(evt);
        }, true);

        document.body.addEventListener("keydown", (evt)=>{
            self.handleElementKeydown(evt);
        }, true);

        window.addEventListener("pointerover", (evt)=>{
            self.handlePointerOver(evt);
        }, false);

        document.addEventListener("pointerleave", (evt)=>{
            self.updateHoveredElements([]);
        }, false);

        window.addEventListener("beforeunload", (evt)=>{
            self.pushEvent("unload", {});

            this.postEvents().then(()=>{
            });
        });

        window.addEventListener("resize", (evt)=>{
            self.handleWindowResize(evt);
        });
        //Send fake resize event, to save initial size
        self.handleWindowResize({});

        window.addEventListener("pointermove", (evt)=>{
            self.handleMove(evt);
        });

        let tagVisibleObserver = new IntersectionObserver((entries)=>{
            entries.forEach((entry)=>{
                if(entry.isIntersecting) {
                    //Visible
                    self.pushEvent("taggedvisible", {}, entry.target);
                } else {
                    //Not visible

                    if(entry.target.intersectionJustAdded) {
                        entry.target.intersectionJustAdded = false;
                    } else {
                        self.pushEvent("taggedinvisible", {}, entry.target);
                    }
                }
            });
        }, {
            threshold: 0.2
        });

        cQuery("body").liveQuery("[data-tag]", {
            added: (elm)=> {
                elm.intersectionJustAdded = true;
                tagVisibleObserver.observe(elm);
            },
            removed: (elm) => {
                delete elm.intersectionJustAdded;
                tagVisibleObserver.unobserve(elm);
            }
        })
    }

    getTags(element, skipParents=false) {
        let allTags = new Set();

        if(element.getAttribute != null) {
            let tagAttr = element.getAttribute("data-tag");

            if (tagAttr != null) {
                let tagsOnElement = tagAttr.split(" ");
                tagsOnElement = tagsOnElement.filter((tag) => {
                    return tag.trim().length > 0;
                });

                tagsOnElement.forEach((tag)=>{
                    allTags.add(tag);
                })
            }
        }

        if(element.parentNode != null && !skipParents) {
            let parentTags = this.getTags(element.parentNode);

            parentTags.forEach((tag)=>{
                allTags.add(tag);
            })
        }

        return Array.from(allTags);
    }

    countAction() {
        this.actionListeners.forEach((listener)=>{
            listener();
        });
    }

    pushEvent(type, data, elm = null) {
        let evt = {
            "type": type,
            "time": Date.now(),
            "data": data
        };

        if(elm != null) {
            evt.data.elementTags = this.getTags(elm, true);
            evt.data.tags = this.getTags(elm, false);
            evt.data.path = finder(elm);
        }

        this.events.push(evt);
    }

    findTaggedParents(elm) {
        let taggedElements = [];

        let tags = this.getTags(elm, true);

        if(tags.length > 0) {
            taggedElements.push(elm);
        }

        if(elm.parentElement != null) {
            let parentTaggedElements = this.findTaggedParents(elm.parentElement);

            parentTaggedElements.forEach((parent)=>{
                taggedElements.push(parent);
            })
        }

        return taggedElements;
    }

    handlePointerOver(evt) {
        let taggedElementsHovered = this.findTaggedParents(evt.target);

        this.updateHoveredElements(taggedElementsHovered);
    }

    updateHoveredElements(taggedElementsHovered) {
        const self = this;

        this.currentlyHoveredTaggedElements.forEach((elm)=>{
            elm.stillHovered = false;
        });

        taggedElementsHovered.forEach((elm)=>{
            elm.stillHovered = true;
            if(!self.currentlyHoveredTaggedElements.has(elm)) {
                self.currentlyHoveredTaggedElements.add(elm);
                self.pushEvent("pointerover", {}, elm);
            }
        });

        let deleteElements = [];

        this.currentlyHoveredTaggedElements.forEach((elm)=>{
            if(!elm.stillHovered) {
                deleteElements.push(elm);
                self.pushEvent("pointerout", {}, elm);
            }
        });

        deleteElements.forEach((elm)=>{
            this.currentlyHoveredTaggedElements.delete(elm);
        });
    }

    handleMove(evt) {
        let pos = {
            x: evt.pageX,
            y: evt.pageY
        };

        let now = Date.now();

        if(now - this.lastPointerMove > this.options.pointerMoveThrottleInterval) {
            this.pushEvent("pointermove", pos);
            this.lastPointerMove = now;
        }

        this.moveListeners.forEach((listener)=>{
            listener(pos);
        });
    }

    handleElementKeyup(evt) {
        this.pushEvent("keyup", {
            keyCode: evt.keyCode,
        }, evt.target);
    }

    handleElementKeydown(evt) {
        this.pushEvent("keydown", {
            keyCode: evt.keyCode,
        }, evt.target);
    }
    handleElementInput(evt) {
        this.countAction();
        this.pushEvent("input", {
            data: evt.data,
            value: evt.target.value,
        }, evt.target);
    }

    handleElementClick(evt) {
        this.pushEvent("click", {
            x: evt.pageX,
            y: evt.pageY,
        }, evt.target);

        this.checkForNavigation(evt.target);
    }

    checkForNavigation(elm) {
        //Check if this was a navigation click
        if(elm.matches("[data-link]")) {
            let url = elm.getAttribute("data-link");
            let target = elm.getAttribute("target");
            this.pushEvent("navigation", {
                url: url,
                target: target
            }, elm);
        } else if(elm.matches("a")) {
            let url = elm.getAttribute("href");
            let target = elm.getAttribute("target");

            if(url == null || url.trim().length === 0 || url.trim() === "#") {
                console.log("Skipping navigation based on url:", url);
                return;
            }

            this.pushEvent("navigation", {
                url: url,
                target: target
            }, elm);
        } else {
            //Check if any parent has data-link
            let dataLinkParent = elm.closest("[data-link]");
            if(dataLinkParent != null) {
                this.checkForNavigation(dataLinkParent);
            } else {
                let aParent = elm.closest("a");
                if(aParent != null) {
                    this.checkForNavigation(aParent);
                }
            }
        }
    }

    handleElementDown(evt) {
        this.countAction();
        this.pushEvent("pointerdown", {
            x: evt.pageX,
            y: evt.pageY,
        }, evt.target);
    }

    handleElementUp(evt) {
        this.pushEvent("pointerup", {
            x: evt.pageX,
            y: evt.pageY,
        }, evt.target);
    }
    handleWindowFocus(evt) {
        this.pushEvent("windowfocus", {
        });
    }

    handleWindowBlur(evt) {
        this.pushEvent("windowblur", {
        });
    }

    handleElementFocus(evt) {
        this.pushEvent("elementfocus", {
        }, evt.target);
    }

    handleElementBlur(evt) {
        this.pushEvent("elementblur", {
        }, evt.target);
    }

    handleWindowResize(evt) {
        this.pushEvent("windowresize", {
            width: window.innerWidth,
            height: window.innerHeight
        });
    }

    setupSpeedTrackers() {
        const self = this;

        console.log("Setting up speed trackers...");

        //Actions Per Minute
        let actions = 0;

        this.actionListeners.push(()=>{
            actions++;
        });

        let lastAPM = -1;
        let lastPointerSpeed = -1;

        setInterval(()=>{
            let apm = (actions / (self.options.apmUpdateInterval / 1000.0)) * 60.0;
            actions = 0;

            if(apm === 0 && lastAPM === 0) {
                //Dont send APM, if we already said 0, and new value is 0
                return;
            }

            lastAPM = apm;

            self.pushEvent("actionsperminute", {
                apm: apm
            });
        }, this.options.apmUpdateInterval);

        //Mouse Speed
        let avgSpeed = -1;
        let lastPos = null;
        let totalDistance = 0;
        this.moveListeners.push((pos)=>{
            if(lastPos != null) {
                //Find X,Y of movement vector
                let deltaX = Math.abs(lastPos.x - pos.x);
                let deltaY = Math.abs(lastPos.y - pos.y);

                let distance = Math.sqrt(Math.pow(deltaX, 2) + Math.pow(deltaY, 2));

                totalDistance += distance;
            }
            lastPos = pos;
        });

        setInterval(()=>{
            let speed = totalDistance / (self.options.speedUpdateInterval / 1000.0);

            if(speed === 0 && lastPointerSpeed === 0) {
                //Dont send APM, if we already said 0, and new value is 0
                return;
            }

            lastPointerSpeed = speed;

            self.pushEvent("pointerspeed", {
                speed: speed
            });

            totalDistance = 0;
        }, this.options.speedUpdateInterval);
    }

    async visualizeSubsession(subsession, options = {}) {
        let events = await this.getEventsFromSubsession(subsession, options);

        let maxWidth = 0;
        let maxHeight = 0;

        events.forEach((event)=>{
            if(event.type === "windowresize") {
                maxWidth = Math.max(maxWidth, event.data.width);
                maxHeight = Math.max(maxHeight, event.data.height);
            } else {
                if(event.data.x) {
                    maxHeight = Math.max(maxHeight, event.data.y);
                    maxWidth = Math.max(maxWidth, event.data.x);
                }
            }
        });

        const draw = SVG().size(maxWidth, maxHeight);

        let lastPositionX = null;
        let lastPositionY = null;
        let timestampLastPosition = null;

        let pointerIsDown = false;

        const defaultDrawOptions = {
            move: {
                color: "black",
                timeFactor: 2,
                "strokeDash": null
            },
            drag:{
                color: "black",
                "strokeDash": "4"
            },
            click: {
                color: "red",
                size: 10
            },
            up: {
                color: "blue",
                size: 5
            },
            down: {
                color: "green",
                size: 7
            }
        }

        Object.keys(defaultDrawOptions).forEach((key)=>{
            let defaultOptions = defaultDrawOptions[key];

            if(options[key] !== false) {
                options[key] = Object.assign({}, defaultOptions, options[key]);
            }
        })

        function drawPath(x, y, time, color, timeFactor, strokeDash) {
            let arcRadius = 0;

            if(timestampLastPosition != null) {
                let line = draw.line(lastPositionX, lastPositionY, x, y).fill({color: color}).stroke({width: 1, color: color});

                if(strokeDash != null) {
                    line.node.setAttribute("stroke-dasharray", strokeDash);
                }

                let timeDiffSeconds = (time - timestampLastPosition) / 1000.0;
                arcRadius += timeDiffSeconds * timeFactor;
            }

            let circle = draw.circle(arcRadius*2);
            circle.center(x,y);
            circle.fill({color: color}).stroke({color: color, width: 1});

            lastPositionX = x;
            lastPositionY = y;
            timestampLastPosition = time;
        }

        function drawCircle(x,y, color, size) {
            let circle = draw.circle(size*2);
            circle.center(x,y);
            circle.fill("none").stroke({width: 1, color: color});
        }

        //Draw pointer path
        events.forEach((event)=>{
            switch(event.type) {
                case "pointermove":
                    if(options.move !== false) {
                        drawPath(event.data.x, event.data.y, event.time, pointerIsDown?options.drag.color:options.move.color, options.move.timeFactor, pointerIsDown?options.drag.strokeDash:options.move.strokeDash);
                    }

                    break;

                case "click":
                    if(options.move !== false) {
                        drawPath(event.data.x, event.data.y, event.time, options.move.color, options.move.timeFactor, options.move.strokeDash);
                    }

                    if(options.click !== false) {
                        drawCircle(event.data.x, event.data.y, options.click.color, options.click.size);
                    }

                    break;

                case "pointerdown":
                    if(options.move !== false) {
                        drawPath(event.data.x, event.data.y, event.time, options.move.color, options.move.timeFactor);
                    }

                    if(options.down !== false) {
                        drawCircle(event.data.x, event.data.y, options.down.color, options.down.size);
                    }

                    pointerIsDown = true;

                    break;

                case "pointerup":
                    if(options.move !== false) {
                        drawPath(event.data.x, event.data.y, event.time, pointerIsDown?options.drag.color:options.move.color, options.move.timeFactor,  pointerIsDown?options.drag.strokeDash:options.move.strokeDash);
                    }

                    if(options.up !== false) {
                        drawCircle(event.data.x, event.data.y, options.up.color, options.up.size);
                    }

                    pointerIsDown = false;

                    break;

                default:
            }
        });

        return draw.node;
    }
}

window.UberTracker = UberTracker;

</script>

            </wpm-package>
            <wpm-package id="AssetFetcher">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Lightweight asset downloader extension for WPM",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "license": "Apache 2.0"
}

</script>

                <script id="assetfetcher-script" type="disabled">
window.WPMv2.installAsset = async function installAsset(destination, source){
    if(typeof webstrate  !== "undefined") {
        let asset = webstrate.assets.findLast(a=>a.fileName==destination);
        if ((!asset) || (asset.deletedAt)){
            console.log("Initial fetch of asset "+destination+" from "+source+" ...");
            let formData = new FormData();
            
            let response = await fetch(source, {credentials: 'same-origin'});
            let blob = await response.blob();          
            formData.append("file", blob, destination);
            await fetch(location.pathname, {
                body: formData,
                credentials: 'same-origin',
                method: "post"
            });            
            return true;
        }
    } else {
        console.log("AssetFetcher: Don't know how to fetch asset "+destination+" when not using webstrates, please manually download it from "+source);
    }
    return false;
}

</script>

            </wpm-package>
            <wpm-package id="coi-serviceworker">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Cross-Origin Isolation Service Worker",
    "dependencies": [
        "#AssetFetcher"
    ],
    "license": "MIT",
    "assets": [],
    "version": "0.1.7"
}

</script>

                <script type="disabled">
                    await WPMv2.installAsset("coi-serviceworker-v1.7.js", "https://libraries.projects.cavi.au.dk/javascript/coi-serviceworker/1.7/coi-serviceworker.min.js");

                    window.coi = {
                        shouldRegister: () => true,
                        shouldDeregister: () => false,
                        coepCredentialless: () => true,
                        doReload: () => {console.log("COI needs reload");window.coiNeedsReload=true},
                        quiet: false
                    }    
    
                    var s = document.createElement('script');
                    s.src = 'coi-serviceworker-v1.7.js';
                    document.body.appendChild(s);
                </script>
            </wpm-package>            
            <wpm-package id="CaviDraggableHTML5">
                <script id="descriptor-script" type="descriptor">
{
    "description": "CaviDraggableHTML5 makes HTML5 dnd api easy to use",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "changelog": {
    },
    "license": "Apache 2.0",
    "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/CaviDraggableHTML5/1.0/draggable.min.js");
                </script>
            </wpm-package>
            <wpm-package id="CaviTouch">
                <script id="descriptor-script" type="descriptor">
{
    "description": "CaviTouch is a library to seemlesly handle touch, mouse, pointers and gestures",
    "dependencies": [],
    "assets": [],
    "version": "1.4",
    "changelog": {
        "1.0": "Initial version",
        "1.1": "Added upgrade workaround",
        "1.2": "Fixed bug during upgrade",
        "1.3": "Fixed another bug during upgrade",
        "1.4": "Moved to CDN and minified"
    },
    "documentationLink": "",
    "license": "Apache 2.0"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/CaviTouch/1.4/CaviTouch.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="babel">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Babel transpiler",
    "dependencies": [
    ],
    "assets": [],
    "version": "7.23.10",
    "license": "MIT",
    "documentationLink": "https://github.com/babel/babel"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://unpkg.com/@babel/standalone@7.23.10/babel.min.js");
                </script>
            </wpm-package>              
            <wpm-package id="Rangy">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Library to help with range selection and manipulation",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "1.3.1",
    "license": "MIT",
    "documentationLink": "https://github.com/timdown/rangy/wiki"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/rangy/1.3.1/rangy-core.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="RangyClassApplier">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Can toggle classes on rangy selections",
    "dependencies": ["#Rangy"],
    "assets": [],
    "version": "1.3.0",
    "license": "MIT",
    "documentationLink": "https://github.com/timdown/rangy/wiki/Class-Applier-Module"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/rangy/1.3.1/rangy-classapplier.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="Aja">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Ajax without XML, Asynchronous JavaScript And JSON(P)",
    "dependencies": [],
    "assets": [],
    "license": "MIT",    
    "version": "0.4.1",
    "documentationLink": "http://krampstudio.com/aja.js/#samples"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/aja/0.4.1/aja.min.js");
                </script>
            </wpm-package>  
            <wpm-package id="microdiff">
                <script id="descriptor-script" type="descriptor">
{
    "description": "MicroDiff JSON object differ",
    "dependencies": [
    ],
    "assets": [],
    "version": "1.3.2",
    "license": "MIT",
    "documentationLink": "https://github.com/AsyncBanana/microdiff"
}

</script>

                <script type="disabled">
                    let module = await import("https://cdn.jsdelivr.net/npm/microdiff@1.3.2/+esm");
                    window.microdiff = {diff:module.default};
                </script>
            </wpm-package>              
            <wpm-package id="micropatch">
                <script id="descriptor-script" type="descriptor">
{
    "description": "MicroPatch JSON object patcher",
    "dependencies": [
    ],
    "assets": [],
    "version": "1.0.0",
    "license": "MIT",
    "documentationLink": "https://github.com/AsyncBanana/micropatch"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/micropatch/1.0.0/micropatch.js");
                </script>
            </wpm-package>               
            <wpm-package id="Awesomplete">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Ultra lightweight, customizable, simple autocomplete widget",
    "dependencies": [],
    "assets": [],
    "version": "1.1.4",
    "license": "MIT",        
    "documentationLink": "https://leaverou.github.io/awesomplete/#basic-usage"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.2/awesomplete.min.js");
                </script>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.2/awesomplete.min.css" rel="stylesheet" type="text/css"/>
            </wpm-package>   
            <wpm-package id="Showdown">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A Markdown to HTML converter written in Javascript",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "1.9.0",
    "license": "MIT",
    "documentationLink": "http://showdownjs.com/#!/documentation"
}

</script>

                <script type="disabled">
                    window.ShowdownLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/showdown";
                    {
                        requirejs.config({
                            paths: {
                                showdown: ShowdownLibraryPath
                            }
                        });                        
                    }
                </script>
            </wpm-package>   
            <wpm-package id="latex_js">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Latex.js, Latex to html generator",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "0.12.1",
    "license": "MIT",
    "documentationLink": "https://latex.js.org"
}

</script>

                <script type="disabled">
                    window.LatexJSLibraryPath = "https://cdn.jsdelivr.net/npm/latex.js@0.12.1/dist";
                </script>
            </wpm-package>   
            <wpm-package id="Quadtree">
                <script id="descriptor-script" type="descriptor">
{
    "description": "JavaScript Quadtree implementation",
    "dependencies": [],
    "assets": [],
    "version": "1.2",
    "license": "MIT",
    "documentationLink": "https://github.com/timohausmann/quadtree-js"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/Quadtree/quadtree.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="CanvasToBlob">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Library to convert canvas elements into Blob objects.",
    "dependencies": [],
    "assets": [],
    "version": "3.14.0",
    "license": "MIT",
    "documentationLink": "https://github.com/blueimp/JavaScript-Canvas-to-Blob"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/javascript-canvas-to-blob/3.14.0/js/canvas-to-blob.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="Slider">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A slider widget",
    "dependencies": [
        "#cQuery",
        "#CaviTouch"
    ],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/Slider/1.0/Slider.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="SVGCanvas">
                <script id="descriptor-script" type="descriptor">
{
    "description": "SVG canvas for drawing",
    "dependencies": [
        "#cQuery",
        "#CaviTouch",
        "#kd-tree"
    ],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/SVGCanvas/1.0/SVGCanvas.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="kd-tree">
                <script id="descriptor-script" type="descriptor">
{
    "description": "JavaScript kd-tree implementation",
    "dependencies": [],
    "assets": [],
    "version": "1.01",
    "license": "MIT",
    "documentationLink": "https://github.com/ubilabs/kd-tree-javascript"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/kd-tree/kdTree-min.js");
                </script>
            </wpm-package>
            <wpm-package id="d3">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Data-Driven Documents (d3.js) graph engine",
    "dependencies": [],
    "assets": [],
    "license": "BSD-2-Clause (ISC)",
    "version": "6",
    "documentationLink": "https://github.com/d3/d3"
}

</script>

                <script type="disabled">
                    window.d3jsLibraryPath = "https://d3js.org/d3.v6.min";
                    {
                        requirejs.config({
                            paths: {
                                "d3@6": d3jsLibraryPath
                            }
                        });                        
                    }                    
                    //await wpm.requireExternal("https://d3js.org/d3.v6.min.js");
                </script>
            </wpm-package>            
            <wpm-package id="diffHTML">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A JavaScript diffing algorithm for DOM elements",
    "dependencies": [],
    "assets": [],
    "version": "1.0.0-beta.27",
    "license": "MIT",
    "documentationLink": "https://github.com/tbranyen/diffhtml/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://unpkg.com/diffhtml@1.0.0-beta.27/dist/diffhtml.min.js");
                </script>
            </wpm-package>
            <wpm-package id="diffDOM">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A JavaScript diffing algorithm for DOM elements",
    "dependencies": [],
    "assets": [],
    "version": "4.1.6",
    "license": "LGPL 3.0",
    "documentationLink": "https://github.com/fiduswriter/diffDOM"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/diffDOM/diffDOM.js");
                </script>
            </wpm-package>
            <wpm-package id="Uploader">
                <script id="descriptor-script" type="descriptor">
{
  "description": "An upload helper",
  "dependencies": [
    "#cQuery"
  ],
  "assets": [],
  "version": "1.0",
  "changelog": {
    "1.0": "Initial version"
  },
  "license": "Apache 2.0",
  "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/exif-js@2.3.0/exif.min.js");
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/Uploader/1.0/Uploader.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="Observer">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Webstrate iframe observer, can wait for transclude, and changes to have propagated to server",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "license": "Apache 2.0",
    "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/Observer/1.0/Observer.min.js");
                </script>
            </wpm-package>
            <wpm-package id="FastDOM">
                <script id="descriptor-script" type="descriptor">
{
    "description": "FastDOM, make sure measure and mutate dom operations are made correctly",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "license": "MIT",
    "documentationLink": "https://github.com/wilsonpage/fastdom"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/fastdom/1.0.10/fastdom.min.js");
                </script>
            </wpm-package>
            <wpm-package id="pep">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Pointer Events Polyfill",
    "dependencies": [],
    "assets": [],
    "version": "0.4.3",
    "license": "MIT",
    "documentationLink": "https://github.com/jquery/PEP"
}

</script>

                <script type="disabled">
                    wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/pep/pep.js");
                </script>
            </wpm-package>
            <wpm-package id="BezierCurves">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Utilities for working with Bezier curves",
    "dependencies": [
    ],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "license":"MIT",
    "documentationLink": "https://github.com/Pomax/bezierjs & https://github.com/soswow/fit-curves"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/BezierCurves/bezier.js");
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/BezierCurves/fit-curve.min.js");
                </script>
            </wpm-package>
            <wpm-package id="PixiCanvas">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Drawing canvas, implemented using pixijs",
    "dependencies": [
        "#cQuery",
        "#CaviTouch",
        "#BezierCurves",
        "#pixijs"
    ],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/PixiCanvas/1.0/PixiCanvas.min.js");
                </script>
            </wpm-package>
            <wpm-package id="Moment">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Parse, validate, manipulate, and display dates and times in JavaScript.",
    "dependencies": [],
    "assets": [],
    "version": "2.23.0",
    "license": "MIT",
    "documentationLink": "https://momentjs.com/docs/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/Moment/moment.min.js");
                </script>
            </wpm-package>
            <wpm-package id="date-fns">
                <script id="descriptor-script" type="descriptor">
{
    "description": "date-fns",
    "dependencies": [],
    "assets": [],
    "version": "1.30.1",
    "license": "MIT",
    "documentationLink": "https://date-fns.org/docs/Getting-Started/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/date-fns/date_fns.min.js");
                </script>
            </wpm-package>
            <wpm-package id="anchorme">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Anchorme",
    "dependencies": [
    ],
    "assets": [],
    "version": "1.1.2",
    "license": "MIT",    
    "changelog": {
        "1.1.2": "Initial version"
    },
    "documentationLink": "http://alexcorvi.github.io/anchorme.js/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/anchorme/anchorme.min.js");
                </script>
            </wpm-package>
            <wpm-package id="fingerprintjs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "FingerPrintJS",
    "dependencies": [
    ],
    "assets": [],
    "license": "MIT",
    "version": "3.3.4",
    "documentationLink": "https://github.com/fingerprintjs/fingerprintjs/"
}

</script>

                <script type="disabled">
                    try {
                        await wpm.requireExternal('https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3.3.6/dist/fp.min.js');
                    } catch(e) {
                        await wpm.requireExternal('https://libraries.projects.cavi.au.dk/javascript/fingerprinting/fp.min.js');
                    }
                </script>  
            </wpm-package>
            <wpm-package id="nouislider">
                <script id="descriptor-script" type="descriptor">
{
    "description": "noUISlider",
    "dependencies": [],
    "assets": [],
    "version": "13.1.1",
    "license": "MIT",
    "documentationLink": "https://refreshless.com/nouislider/"
}

</script>

                <link href="https://libraries.projects.cavi.au.dk/javascript/nouislider/nouislider.min.css" rel="stylesheet" type="text/css"/>
                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/nouislider/nouislider.min.js");
                </script>
            </wpm-package>
            <wpm-package id="Levenshtein">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A very efficient JS implementation calculating the Levenshtein distance, i.e. the difference between two strings.",
    "dependencies": [
    ],
    "assets": [],
    "version": "0.1",
    "changelog": {
        "0.1": "Initial version"
    },
    "license":"MIT",
    "documentationLink": "https://github.com/gustf/js-levenshtein"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/Levenshtein/1.1.6/levenshtein.min.js");
                </script>
            </wpm-package>
            <wpm-package id="metamax">
                <script id="descriptor-script" type="descriptor">
{
    "description": "MetaMax - Videostrate Caching Server",
    "dependencies": [],
    "assets": [],
    "version": "0.1"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://stream.cavi.au.dk/cache/js/MetaMaxCache.js");
                </script>
            </wpm-package>
            <wpm-package id="pyodide">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Pyodide, The Python scientific stack, compiled to WebAssembly.",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "?",
    "license": "MPL-2.0",
    "documentationLink": "https://pyodide.readthedocs.io/en/latest/"
}

</script>

                <script type="disabled">
                    window.PyodideLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/pyodide/";
                    window.languagePluginUrl = PyodideLibraryPath;
                </script>
            </wpm-package>
            <wpm-package id="typescript">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Typescript compiler for js",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "3.5.2",
    "license": "Apache 2.0",
    "documentationLink": "http://www.typescriptlang.org/docs/home.html"
}

</script>

                <script type="disabled">
                    window.TypescriptLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/typescript";
                    {
                        requirejs.config({
                            paths: {
                                typescript: TypescriptLibraryPath
                            }
                        });                        
                    }
                </script>
            </wpm-package>
            <wpm-package id="paho-mqtt">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Eclipse Paho - MQTT over Websockets",
    "dependencies": [],
    "assets": [],
    "version": "1.1.0",
    "license": "EPL-1.0",
    "documentationLink": "https://www.eclipse.org/paho/index.php?page=clients/js/index.php"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.1.0/paho-mqtt.min.js");
                </script>
            </wpm-package>            
            <wpm-package id="requirejs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Require.js",
    "dependencies": [],
    "assets": [],
    "version": "2.3.6",
    "license": "MIT",
    "documentationLink": "https://requirejs.org/docs/api.html"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/require/require.js");
                </script>
            </wpm-package>
            <wpm-package id="monaco_editor">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Monaco Editor",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "0.33.0",
    "license": "MIT",
    "documentationLink": "https://microsoft.github.io/monaco-editor/api/index.html"
}

</script>

                <script type="disabled">
                    window.MonacoLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/monaco/0.33/vs";
                    
                    {
                        //Configure monaco in require loader
                        requirejs.config({
                            paths: {
                                vs: MonacoLibraryPath
                            }
                        });

                        window.MonacoEnvironment = {
                            getWorkerUrl: function(workerId, label) {
                              return `data:text/javascript;charset=utf-8,${encodeURIComponent(`
                                self.MonacoEnvironment = {
                                  baseUrl: 'https://libraries.projects.cavi.au.dk/javascript/monaco/0.33/'
                                };
                                importScripts('https://libraries.projects.cavi.au.dk/javascript/monaco/0.33/vs/base/worker/workerMain.js');`
                              )}`;
                            }
                          };
                    }
                </script>
            </wpm-package>
            <wpm-package id="codemirror_editor">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Codemirror Editor",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "5.48.0",
    "license": "MIT",
    "documentationLink": "https://codemirror.net/doc/manual.html"
}

</script>

                <script type="disabled">
                    window.CodemirrorLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/codemirror";
                    
                    {
                        requirejs.config({
                            packages: [{
                                name: "cm",
                                location: CodemirrorLibraryPath,
                                main: "lib/codemirror"
                            }]
                        });
                    }
                </script>
            </wpm-package>
            <wpm-package id="ace_editor">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Ace Editor",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "1.4.5",
    "license": "BSD",
    "documentationLink": "https://ace.c9.io"
}

</script>

                <script type="disabled">
                    window.AceLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/ace";
                    {
                        requirejs.config({
                            paths: {
                                ace: AceLibraryPath
                            }
                        });                        
                    }
                </script>
            </wpm-package>
            <wpm-package id="sass_js">
                <script id="descriptor-script" type="descriptor">
{
    "description": "SCSS compiler for JS",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "0.11.1",
    "license": "MIT",
    "documentationLink": "https://github.com/medialize/sass.js"
}

</script>

                <script type="disabled">
                    window.SassJsLibraryPath = "https://libraries.projects.cavi.au.dk/javascript/sass.js/0.11.1";
                    {
                        requirejs.config({
                            paths: {
                                sass: SassJsLibraryPath
                            }
                        });                        
                    }
                    
                    window.fetchSassWorkerBlob = async ()=> {
                        let response = await fetch("https://libraries.projects.cavi.au.dk/javascript/sass.js/0.11.1/sass.worker.min.js");
                        let worker = await response.text();
                        let blob = new Blob([worker], {type: 'application/javascript'});
                        
                        return blob;
                    }
                </script>
            </wpm-package>
            <wpm-package id="opal">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Opal, Ruby for javascript",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "1.0.0",
    "license": "MIT",
    "documentationLink": "http://opalrb.com/docs/"
}

</script>

                <script type="disabled">
                    window.OpalLibraryPath = "//cdn.opalrb.com/opal/1.0.0/";
                    window.OpalInitialized = false;
                    requirejs.config({
                        paths: {
                            opal: OpalLibraryPath
                        }
                    });
                </script>
            </wpm-package>
            <wpm-package id="dialog-polyfill">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Polyfill for dialogs",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "license": "BSD",
    "documentationLink": "https://github.com/GoogleChrome/dialog-polyfill"
}

</script>

                <link href="https://cdn.jsdelivr.net/npm/dialog-polyfill@0.5.6/dist/dialog-polyfill.css" rel="stylesheet" type="text/css"/>
                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/dialog-polyfill@0.5.6/dist/dialog-polyfill.min.js");
                </script>
            </wpm-package>
            
            <wpm-package id="fastdiff">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Fast Diff",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "version": "2019",
    "license": "Apache 2.0",
    "documentationLink": "https://github.com/google/diff-match-patch"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/fastdiff/2019/fastdiff.min.js");
                </script>
            </wpm-package>
            <wpm-package id="pixijs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Pixijs library",
    "dependencies": [
    ],
    "assets": [],
    "version": "6.0.2",
    "changelog": {},
    "license": "MIT",
    "documentationLink": "https://www.pixijs.com"
}

</script>

                <script type="disabled">
                    //Load pixi into global space?
                    let pixiJsUrl = "https://libraries.projects.cavi.au.dk/javascript/PixiCanvas/pixi.min.js";
                    wpm.requireExternal("https://cdn.jsdelivr.net/npm/pixi.js-legacy@6.0.2/dist/browser/pixi-legacy.min.js");
                </script>
            </wpm-package>
            
            <wpm-package id="material-design-components">
                <script id="components-descriptor-script" type="descriptor">
{
    "description": "Material Design UI (full minified CDN version)",
    "dependencies": [],
    "assets": [],
    "license": "MIT",
    "version": "14.0.0"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/material-components-web/14.0.0/material-components-web.min.js");
                </script>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/material-components-web/7.0.0/material-components-web.min.css" rel="stylesheet" type="text/css"/>
            </wpm-package>
            <wpm-package id="material-design-icons">
                <script id="icons-descriptor-script" type="descriptor">
{
    "description": "Material Design Icons (full minified CDN version)",
    "dependencies": [],
    "assets": [],
    "license": "Apache 2.0",
    "version": "0.1",
    "documentationLink": "https://github.com/google/material-design-icons"
}

</script>

                <link href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet" type="text/css"/>
            </wpm-package>

            <wpm-package id="golden-layout">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Golden Layout",
    "dependencies": [
        "#requirejs",
        "#cQuery"
    ],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "documentationLink": "https://golden-layout.com/",
    "license": "MIT"
}

</script>

                <script type="disabled">

                    window.GoldenLayoutPath = "https://libraries.projects.cavi.au.dk/javascript/golden-layout";

                    let goldenLayoutLoadPromise = null;

                    window.loadGoldenLayout = async (bodyElement) => {
                        if(goldenLayoutLoadPromise != null) {
                            console.trace();
                            await goldenLayoutLoadPromise;
                            return;
                        }

                        goldenLayoutLoadPromise = new Promise(async (resolve)=>{

                            console.log("Loading GoldenLayout with body replacement:", bodyElement);

                            //Find top component after html
                            let topLevelParent = bodyElement;
                            while(topLevelParent.parentNode != null && !topLevelParent.parentNode.matches("html")) {
                                topLevelParent = topLevelParent.parentNode;
                            }

                            await wpm.requireExternal("https://code.jquery.com/jquery-3.4.1.slim.min.js");

                            let origJQueryOffset = jQuery.fn.offset;

                            jQuery.fn.offset = function() {
                                let el = this[0];
                                var rect = el.getBoundingClientRect();

                                let bounds = topLevelParent.getBoundingClientRect();

                                return {
                                  top: rect.top - bounds.y  + topLevelParent.scrollTop,
                                  left: rect.left - bounds.x + topLevelParent.scrollLeft
                                };
                            };

                            let origJqueryCss = jQuery.fn.css;

                            jQuery.fn.css = function(...args) {
                                if(this.is("body") || this.is("html")) {
                                    console.log("Skipping css on html and body");
                                    return;
                                }

                                return origJqueryCss.bind(this)(...args);
                            };

                            //Setup override event listener
                            var origAddEventListener = EventTarget.prototype.addEventListener;
                            EventTarget.prototype.addEventListener = function(type, fn, capture) {
                                if(type === "mousedown" && this.matches != null && (this.matches(".lm_tab") || this.matches(".lm_splitter"))) {
                                    origAddEventListener.bind(this)(type, (evt)=>{
                                        let bounds = topLevelParent.getBoundingClientRect();

                                        let evtOverrides = new Map();

                                        evtOverrides.set("pageX", evt.pageX - bounds.x);
                                        evtOverrides.set("pageY", evt.pageY - bounds.y);

                                        let evtProxy = new Proxy(evt, {
                                            get: (obj, prop)=>{
                                                if(evtOverrides.has(prop)) {
                                                    let override = evtOverrides.get(prop);
                                                    return typeof override === "function" ? override.bind(obj) : override;
                                                } else {
                                                    return typeof obj[prop] === "function" ? obj[prop].bind(obj) : obj[prop];
                                                }
                                            }
                                        });

                                        fn(evtProxy);

                                    }, capture);
                                } else {
                                    origAddEventListener.bind(this)(type, fn, capture);
                                }
                            }

                            await wpm.requireExternal(GoldenLayoutPath+"/goldenlayout-base.css");
                            await wpm.requireExternal(GoldenLayoutPath+"/goldenlayout-light-theme.css");

                            let documentOverrides = new Map();

                            documentOverrides.set("body", bodyElement);

                            documentOverrides.set("addEventListener", (eventName, callback, options)=>{
                                if(options != null) {
                                    console.log("OPTIONS!!!", options);
                                }

                                cQuery(document).on(eventName, (evt)=>{
                                    let bounds = topLevelParent.getBoundingClientRect();

                                    let evtOverrides = new Map();

                                    evtOverrides.set("pageX", evt.pageX - bounds.x);
                                    evtOverrides.set("pageY", evt.pageY - bounds.y);

                                    let evtProxy = new Proxy(evt, {
                                        get: (obj, prop)=>{
                                            if(evtOverrides.has(prop)) {
                                                let override = evtOverrides.get(prop);
                                                return typeof override === "function" ? override.bind(obj) : override;
                                            } else {
                                                return typeof obj[prop] === "function" ? obj[prop].bind(obj) : obj[prop];
                                            }
                                        }
                                    });

                                    callback(evtProxy);
                                }, options);
                            });

                            documentOverrides.set("removeEventListener", (eventName, callback, options)=>{
                                cQuery(document).off(eventName);
                            });

                            documentOverrides.set("querySelector", (selector)=>{
                                console.log("querySelector", selector);
                                return document.querySelector(selector);
                            });

                            documentOverrides.set("querySelectorAll", (selector)=>{
                                console.log("querySelectorAll", selector);
                                return document.querySelectorAll(selector);
                            });

                            let documentProxy = new Proxy(document, {
                                get: (obj, prop)=>{
                                    if(documentOverrides.has(prop)) {
                                        let override = documentOverrides.get(prop);
                                        return typeof override === "function" ? override.bind(obj) : override;
                                    } else {
                                        return typeof obj[prop] === "function" ? obj[prop].bind(obj) : obj[prop];
                                    }
                                }
                            });

                            async function internalLoad(document) {

                                let response = await fetch(GoldenLayoutPath+"/goldenlayout.min.js", {credentials: 'same-origin'});
                                let scriptContent = await response.text();

                                let origDefine = window.define;
                                if (window.define != null) {
                                    window.define = null;
                                }

                                eval(scriptContent);

                                //Restore previous define, if this script did not set define
                                if (window.define === null && origDefine != null) {
                                    window.define = origDefine;
                                }
                            }

                            await internalLoad(documentProxy);

                            resolve();
                        });

                        await goldenLayoutLoadPromise;
                    };
                </script>
            </wpm-package>
            <wpm-package id="golden-layout_material-design-theme">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Material Design Theme bindings for Golden Layout",
    "dependencies": [
        "#golden-layout"
    ],
    "assets": [],
    "version": "1.0",
    "changelog": {
        "1.0": "Initial version"
    },
    "license": "Apache 2.0"
}

</script>

                <style id="gl-mdc-binding-style">
.lm_goldenlayout .lm_content {
  background: var(--mdc-theme-background); }

.lm_maximised .lm_header {
  background-color: var(--mdc-theme-surface); }

.lm_goldenlayout .lm_header .lm_tab {
  background: var(--mdc-theme-surface);
  border: 0;
  user-select: none; }
  .lm_goldenlayout .lm_header .lm_tab .lm_title {
    color: var(--mdc-theme-on-surface); }
  .lm_goldenlayout .lm_header .lm_tab.lm_active {
    border-bottom: 2px solid var(--mdc-theme-primary);
    box-shadow: none;
    padding-bottom: 4px; }
    .lm_goldenlayout .lm_header .lm_tab.lm_active:before {
      position: absolute;
      top: 0;
      left: 0;
      background: var(--mdc-theme-primary);
      opacity: 0.04;
      content: "";
      width: 100%;
      height: 100%; }
</style>

            </wpm-package>
            <wpm-package id="ohm-js">
                <script id="descriptor-script" type="descriptor">
{
    "description": "ohm-js parser",
    "dependencies": [],
    "assets": [],
    "version": "15.4.1",
    "license": "MIT",
    "documentationLink": "https://github.com/harc/ohm"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("//unpkg.com/ohm-js@15.4.1/dist/ohm.min.js");
                </script>
            </wpm-package>     
            <wpm-package id="qrcodejs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "QR code generator",
    "dependencies": [],
    "assets": [],
    "version": "1.0.0",
    "license": "MIT",
    "documentationLink": "https://davidshimjs.github.io/qrcodejs/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/qrcodejs/qrcode.min.js");
                </script>
            </wpm-package>                   
            <wpm-package id="html2canvas">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A screengrabber in js using canvas elements",
    "dependencies": [],
    "assets": [],
    "version": "1.0.0",
    "license": "MIT",
    "documentationLink": "http://html2canvas.hertzen.com/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/html2canvas/html2canvas.min.js");
                </script>
            </wpm-package>
            <wpm-package id="p5js">
                <script id="descriptor-script" type="descriptor">
{
    "description": "p5js",
    "dependencies": [],
    "assets": [],
    "version": "1.0.0",
    "license": "LGPL 2.1",
    "documentationLink": "https://p5js.org/",
    "documentationLicense": "CC-NC-SA 4.0"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.min.js");
                </script>
            </wpm-package>
            <wpm-package id="doppio">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Doppio JavaVM",
    "dependencies": ["#setImmediate", "#browserfs"],
    "assets": [],
    "version": "0.5",
    "license": "MIT",
    "documentationLink": "https://plasma-umass.org/doppio-demo/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/doppio/doppio.js");
                </script>
            </wpm-package>          
            <wpm-package id="browserfs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "BrowserFS - A filesystem in the browser",
    "dependencies": [],
    "assets": [],
    "version": "?",
    "license": "MIT + ?",
    "documentationLink": "https://github.com/jvilk/BrowserFS"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/browserfs/browserfs.min.js");
                </script>
            </wpm-package>   
            <wpm-package id="brython">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Python in the browser",
    "dependencies": [],
    "assets": [],
    "version": "3.8.0",
    "changelog": {
        "3.8.0": "First WPM version"
    },
    "documentationLink": "https://github.com/brython-dev/brython",
    "license": "BSD-3-Clause"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal(["https://libraries.projects.cavi.au.dk/javascript/brython/brython.js"]);
                    await wpm.requireExternal(["https://libraries.projects.cavi.au.dk/javascript/brython/brython_stdlib.js"]);
                </script>
            </wpm-package>                           
            <wpm-package id="setImmediate">
                <script id="descriptor-script" type="descriptor">
{
    "description": "setImmediate polyfill",
    "dependencies": [],
    "assets": [],
    "version": "?"
}

</script>

                <script type="disabled">
                    if (typeof setImmediate === "undefined"){
                        await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/setimmediate/setImmediate.js");
                    }
                </script>
            </wpm-package>               
            <wpm-package id="fengari">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Lua VM for javascript",
    "dependencies": [
        "#requirejs"
    ],
    "assets": [],
    "license": "MIT",
    "version": "0.1.4",
    "documentationLink": "https://github.com/fengari-lua/fengari"
}

</script>

                <script type="disabled">
                    {
                        requirejs.config({
                            paths: {
                                fengari: "https://libraries.projects.cavi.au.dk/javascript/fengari/"
                            }
                        });
                    }
                </script>
            </wpm-package>
            <wpm-package id="esprima">
                <script id="descriptor-script" type="descriptor">
{
    "description": "p5js",
    "dependencies": [],
    "assets": [],
    "version": "1.0.0",
    "license": "LGPL 2.1",
    "documentationLink": "https://p5js.org/",
    "documentationLicense": "CC-NC-SA 4.0"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("//unpkg.com/esprima@~4.0/dist/esprima.js");
                </script>
            </wpm-package>
            <wpm-package id="fontawesome">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Font Awesome - An icon set as a font",
    "dependencies": [],
    "assets": [],
    "license": "Font Awesome",
    "version": "5.15.4",
    "documentationLink": "https://fontawesome.com/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("//kit.fontawesome.com/ce5d6e118c.js");
                </script>
            </wpm-package>
            <wpm-package id="LiveElement">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A small javascript library to work with 'Live' elements, as they enter the dom",
    "dependencies": [
        "rxjs"
    ],
    "assets": [],
    "version": "0.1",
    "changelog": {
        "0.1": "Initial version"
    },
    "license": "Apache 2.0",
    "documentationLink": ""
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/LiveElement/1.0/LiveElement.min.js");
                </script>
            </wpm-package>
            <wpm-package id="BlocklyCore">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A JavaScript library for building visual programming editors.",
    "dependencies": [
    ],
    "assets": [],
    "version": "4.20201217.0",
    "license": "Apache 2.0",
    "documentationLink": "https://developers.google.com/blockly"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/blockly@4.20201217.0/blockly_compressed.js");
                    //await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/blockly_test/blockly_uncompressed.js");
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/blockly@4.20201217.0/javascript_compressed.js");
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/blockly@4.20201217.0/msg/en.js");

                    //Fix Blockly.SNAP_RADIUS being used for BUMPING as well
                    Blockly.BUMP_RADIUS = 0;
                    Blockly.BlockSvg.prototype.bumpNeighbours = function() {
                      if (!this.workspace) {
                        return;  // Deleted block.
                      }
                      if (this.workspace.isDragging()) {
                        return;  // Don't bump blocks during a drag.
                      }
                      var rootBlock = this.getRootBlock();
                      if (rootBlock.isInFlyout) {
                        return;  // Don't move blocks around in a flyout.
                      }
                      // Loop through every connection on this block.
                      var myConnections = this.getConnections_(false);
                      for (var i = 0, connection; (connection = myConnections[i]); i++) {

                        // Spider down from this block bumping all sub-blocks.
                        if (connection.isConnected() && connection.isSuperior()) {
                          connection.targetBlock().bumpNeighbours();
                        }

                        var neighbours = connection.neighbours(Blockly.BUMP_RADIUS);
                        for (var j = 0, otherConnection; (otherConnection = neighbours[j]); j++) {

                          // If both connections are connected, that's probably fine.  But if
                          // either one of them is unconnected, then there could be confusion.
                          if (!connection.isConnected() || !otherConnection.isConnected()) {
                            // Only bump blocks if they are from different tree structures.
                            if (otherConnection.getSourceBlock().getRootBlock() != rootBlock) {

                              // Always bump the inferior block.
                              if (connection.isSuperior()) {
                                otherConnection.bumpAwayFrom(connection);
                              } else {
                                connection.bumpAwayFrom(otherConnection);
                              }
                            }
                          }
                        }
                      }
                    };
                </script>
            </wpm-package>
            <wpm-package id="rxjs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "RxJS is a library for composing asynchronous and event-based programs by using observable sequences.",
    "dependencies": [
    ],
    "assets": [],
    "version": "6.1.0",
    "changelog": {},
    "license": "Apache 2.0",
    "documentationLink": "https://rxjs-dev.firebaseapp.com/api"
}

</script>

                <script type="disabled">
                    //Get RXJS library used for Subject and Observable and more...
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/rxjs/6.1.0/rxjs.umd.js");
                </script>
            </wpm-package>

            <wpm-package id="aaditmshah-lexer">
                <script id="descriptor-script" type="descriptor">
{
    "description": "An elegant armor-plated JavaScript lexer modelled after flex. Easily extensible to tailor to your need for perfection.",
    "dependencies": [],
    "assets": [],
    "version": "1.7.8",
    "license": "MIT",
    "documentationLink": "https://github.com/aaditmshah/lexer"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/gh/aaditmshah/lexer@1.7.8/lexer.min.js");
                </script>
            </wpm-package>

            <wpm-package id="acorn">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Acorn javascript parser",
    "dependencies": [],
    "assets": [],
    "version": "8.0.4",
    "license": "MIT",
    "documentationLink": "https://github.com/acornjs/acorn"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/acorn/8.0.4/acorn.min.js");
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/acorn-walk/8.0.1/walk.min.js");
                </script>
            </wpm-package>

            <wpm-package id="astring">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Tiny and fast JavaScript code generator from an ESTree-compliant AST.",
    "dependencies": [],
    "assets": [],
    "version": "1.6.0",
    "license": "MIT",
    "documentationLink": "https://github.com/davidbonnet/astring"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/astring@1.6.0/dist/astring.min.js");
                </script>
            </wpm-package>

            <wpm-package id="meriyah">
                <script id="descriptor-script" type="descriptor">
{
    "description": "100% compliant, self-hosted javascript parser with high focus on both performance and stability. Stable and already used in production.",
    "dependencies": [],
    "assets": [],
    "version": "3.1.6",
    "license": "ISC",
    "documentationLink": "https://github.com/meriyah/meriyah/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/meriyah@3.1.6/dist/meriyah.iife.min.js");
                </script>
            </wpm-package>

            <wpm-package id="jsbeautify">
                <script id="descriptor-script" type="descriptor">
{
    "description": "This little beautifier will reformat and re-indent bookmarklets, ugly JavaScript, unpack scripts packed by Dean Edwards popular packer, as well as partly deobfuscate scripts processed by the npm package javascript-obfuscator.",
    "dependencies": [],
    "assets": [],
    "version": "1.13.4",
    "license": "MIT",
    "documentationLink": "https://github.com/beautify-web/js-beautify"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.13.4/beautify.min.js");
                </script>
            </wpm-package>

            <wpm-package id="alertifyjs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "AlertifyJS is a javascript framework for developing pretty browser dialogs and notifications.",
    "dependencies": [],
    "assets": [],
    "version": "1.13.1",
    "license": "GPL-3.0",
    "documentationLink": "https://alertifyjs.com"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js");
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css");
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css");
                </script>
            </wpm-package>

            <wpm-package id="izitoast">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Elegant, responsive, flexible and lightweight notification plugin with no dependencies.",
    "dependencies": [],
    "assets": [],
    "version": "1.4.0",
    "license": "Apache 2.0",
    "documentationLink": "https://izitoast.marcelodolza.com/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.min.js");
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.min.css");
                </script>
            </wpm-package>

            <wpm-package id="threejs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "JavaScript 3D library",
    "dependencies": [],
    "assets": [],
    "version": "r125",
    "license": "MIT",
    "documentationLink": "https://threejs.org/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/three.js/r125/three.min.js");
                </script>
            </wpm-package>
            <wpm-package id="mathjs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Math.js library",
    "dependencies": [],
    "assets": [],
    "version": "9.4.3",
    "license": "Apache 2.0",
    "documentationLink": "https://mathjs.org/docs/index.html"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://unpkg.com/mathjs@9.4.3/lib/browser/math.js");
                </script>
            </wpm-package>
            <wpm-package id="matrix-js-sdk">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Matrix Client for Webstrates",
    "dependencies": [],
    "assets": [],
    "version": "23.2.0",
    "license": "Apache 2.0",
    "documentationLink": "https://github.com/matrix-org/matrix-js-sdk"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/matrix-js-sdk/23.2.0/browser-matrix.min.js");
                    await wpm.requireExternal("https://libraries.projects.cavi.au.dk/javascript/matrix-js-sdk/23.2.0/olm.js");
                </script>
                <script id="MatrixHelper-script" type="disabled">
let getStorage = function getStorage(name, notSetValue){
    let data = localStorage.getItem("matrixHelper."+name);
    if (data===null) return notSetValue;
    try {
        if (data) data = JSON.parse(data);
        return data;
    } catch (ex){
        console.log("matrixHelper localStorage parse error, reverting to default", name, data);
    }
    return notSetValue;
}   
let setStorage = function setStorage(name, value){
    localStorage.setItem("matrixHelper."+name, JSON.stringify(value));
}      
let showAccountSelector = function showAccountSelector(){
    return new Promise((resolve, reject)=>{
        // Show the selector UI
        let popup = document.createElement("transient");
        popup.setAttribute("style", `
            position:fixed;
            backdrop-filter:blur(1em) saturate(0) brightness(0.5);
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            display:flex;
            justify-content:center;
            align-items:center`);
        popup.innerHTML = `
        <style>
            matrixlogin {
                padding:1.5rem;
                max-width: 20rem;
                background:white;
                border-radius:1rem;
                box-shadow:0.25rem 0.25rem 1rem rgba(0,0,0,0.2);
            }
            matrixlogin h1 {
                font-family: sans-serif;
                margin: 0;
                font-size: 1.4rem;
                border-bottom: 1px solid lightgrey;
            }
            matrixlogin ul {
                background: #efefef;
                margin: 0;
                list-style: none;
                padding: 0;        
            }
            matrixlogin ul li {
                position: relative;
                padding: 0.5rem 1rem;
                font-weight: bold;
                font-family: sans-serif;
                cursor: pointer;
                border-bottom: 1px solid lightgrey;
                display: flex;
                flex-direction: column;
                justify-content: center;
                padding-right: 2em;        
                transition: background 0.25s, opacity 0.25s ease-in-out;
                opacity: 0.9;
                min-height: 2.5rem;
            }
            matrixlogin ul li:after {
                position: absolute;
                right: 0;
                content: ">";
                font-size: 2rem;
                font-weight: normal;
                padding-right: 0.5rem;
                opacity: 0.2;
            }
            matrixlogin ul li .server {
                font-size: 0.8em;
                opacity: 0.7;
                font-weight: normal;        
            }
            matrixlogin ul li:hover {
                background: #d9dee5;
                opacity: 1;
            }
            matrixlogin ul li.matrix-new-login {
                opacity: 0.5;
                font-weight: normal;
                font-size: 0.9em;
            }        
            matrixlogin table {
                width: 100%;
            }
            matrixlogin table input {
                width: 100%;
                box-sizing: border-box;
                padding: 0.5em;
            }
            matrixlogin table th {
                text-align: right;
                padding: 0.5em;
                font-weight: normal;        
            }
            matrixlogin table button {
                float: right;
                margin: 1em;
                padding: 0.5em 1em;     
                cursor: pointer;   
            }
            matrixlogin .matrix-spinner {
                display: inline-block;
                position: relative;
                width: 80px;
                height: 80px;
            }
            matrixlogin .matrix-spinner div {
                position: absolute;
                border: 4px solid #1e61c5;
                opacity: 1;
                border-radius: 50%;
                animation: matrix-ripple 1s cubic-bezier(0, 0.2, 0.8, 1) infinite;
            }
            matrixlogin .matrix-spinner div:nth-child(2) {
                animation-delay: -0.5s;
            }
            @keyframes matrix-ripple {
                0% {
                    top: 36px;
                    left: 36px;
                    width: 0;
                    height: 0;
                    opacity: 0;
                }
                4.9% {
                    top: 36px;
                    left: 36px;
                    width: 0;
                    height: 0;
                    opacity: 0;
                }
                5% {
                    top: 36px;
                    left: 36px;
                    width: 0;
                    height: 0;
                    opacity: 1;
                }
                100% {
                    top: 0px;
                    left: 0px;
                    width: 72px;
                    height: 72px;
                    opacity: 0;
                }
            }
            matrixlogin .matrix-flippable {
                contain: paint;
            }
            matrixlogin .matrix-flippable > * {
                transition: transform 0.25s ease-in-out;
                transform: translateX(100%);
                position: absolute;
            }
            matrixlogin .matrix-flippable > *.active {
                transform: translateX(0%);
                position: relative;
            }    
            matrixlogin .matrix-flippable > *.flipped {
                transform: translateX(-100%);
            }    
        </style>
        <matrixlogin>
            <h1>Matrix Authentication</h1>
            <div class="matrix-flippable">
                <ul class="active">
                    <li class="matrix-new-login">Add Account...</li>
                </ul>
                <table id="matrix-login-form">
                    <tr><th>User</th><td><input class="username" placeholder="bob"></td></tr>
                    <tr><th>Server</th><td><input class="server" placeholder="https://someserver.somedomain"></td></tr>
                    <tr><th>Password</th><td><input type="password" placeholder="Password"></td></tr>
                    <tr><th></th><td><button class="matrix-login">Login ></button>            
                </table>
                <div id="matrix-verification">
                    <div style="text-align:center"><div class="matrix-spinner"><div></div><div></div></div></div>
                    <br />
                    Use another Matrix client to verify the login to complete the process            
                </div>
                <div id="matrix-reloaded">
                    <div style="text-align:center;color:darkgreen;font-size:4rem"></div>
                    Account added!                    
                </div>        
            </div>
            <p style="font-size: 0.8rem;opacity: 0.5;margin-bottom: 0;">Warning: Logging in allows all webstrates on this server to (ab)use your account on this device</p>
        </matrixlogin>`;
        
        let logins = getStorage("logins", []);
        if (logins){
            logins.forEach((login)=>{
                let user = login.userId.match("@(.*):")[1];
                let server = login.userId.substr(login.userId.indexOf(":")+1);
                let node = document.createElement("li");
                node.innerHTML = user+"<div class='server'>"+server+"</div>";
                node.addEventListener("click", ()=>{
                    popup.remove();
                    resolve(login);
                });
                popup.querySelector("ul").prepend(node);
            });
        }

        document.body.appendChild(popup);
        popup.querySelector("matrixlogin .matrix-new-login").addEventListener("click", ()=>{
            popup.querySelector(".active").setAttribute("class", "flipped");
            popup.querySelector("#matrix-login-form").classList.add("active");
        });

        popup.querySelector("matrixlogin .matrix-login").addEventListener("click", ()=>{
            popup.querySelector("#matrix-login-form").style.opacity = 0.5;

            let user = popup.querySelector("#matrix-login-form input.username").value;
            let server = popup.querySelector("#matrix-login-form input.server").value;
            let password = popup.querySelector("#matrix-login-form input[type='password']").value;

            let callbacks = {
                loginFailed: ()=>{
                    alert("Username, server or password incorrect!");
                    popup.querySelector("#matrix-login-form").style.opacity=1;
                },
                verificationStarted: ()=>{
                    popup.querySelector(".active").setAttribute("class", "flipped");
                    popup.querySelector("#matrix-verification").setAttribute("class", "active");
                },
                verificationCompleted: (login)=>{
                    popup.querySelector(".active").setAttribute("class", "flipped");
                    popup.querySelector("#matrix-reloaded").setAttribute("class", "active");
                    
                    setTimeout(()=>{
                        popup.remove();
                        resolve(login);
                    }, 3000);
                }
            }
            let login = matrixHelper.login(server, user, password, callbacks);

            // TODO: Maybe don't ask the user to reload?
        });            
        
    });
};

class MatrixHelper {
    static async createClient(overrides={}){
        console.log("Requesting Matrix client", overrides);
        
        if (!window.matrixHelper.chosenLogin){
            // TODO: Check if page has a remembered login
            let hasRememberedLogin = false;
            if (hasRememberedLogin){
                // TODO: Use remembered login for this page            
            }        

            // Pick an account
            window.matrixHelper.chosenLogin = await showAccountSelector();
        }
        
        let login = getStorage("logins."+window.matrixHelper.chosenLogin.userId);
        
        // Null sessions?
        if (login?.deviceToImport?.olmDevice?.sessions){
            login.deviceToImport.olmDevice.sessions = login.deviceToImport.olmDevice.sessions.filter(function(val) { return val !== null; });
        }
        
        // Shutdown previous client (if any)        
        if (window.matrixHelper.client){
            console.log("Shutting down previous matrixHelper client...");
            window.matrixHelper.client.stopClient();
        }
        window.matrixHelper.client = matrixcs.createClient(login); //TODO: actually use the overrides
        return window.matrixHelper.client;
    }

    static async login(url, username, password, callbacks={}){
        // TODO: Check if already logged in with this userid

        // Create initial deviceID
        let client = matrixcs.createClient({
            baseUrl: url
        });
        let details;
        try {
            details = await client.loginWithPassword(username, password);
        } catch (ex){
            if (callbacks.loginFailed) callbacks.loginFailed(ex);
            return;
        }
        console.log(details);

        // Recreate client with a deviceId to initiate crypto verification
        if (callbacks.verificationStarted) callbacks.verificationStarted();
        client = matrixcs.createClient({
            baseUrl: url,
            accessToken: details.access_token,
            userId: details.user_id,
            deviceId: details.device_id
        });
        client.setDeviceDetails(details.device_id, {
            display_name: "Webstrates ("+location.host+")"
        });

        // Wait for verification from another source
        client.on("crypto.verification.request", function (event) {
            console.log("Got verification request:", event);
            event.accept();
            event.on('change', async function () {
                console.log("VerificationRequest.change", event.phase);

                // Phase 4 starts verify process
                if (event.phase === 4) {
                    event._verifier.verify();

                    // Just accept anything
                    setTimeout(function () {
                        console.debug(event);
                        event._verifier.sasEvent.confirm();
                    }, 2000);
                } else if (event.phase === 6){
                    console.log("Verification completed");
                    setTimeout(async function () {
                        let exportedDevice = await client.exportDevice();
                        let logins = getStorage("logins", []);
                        let login = {
                            userId: details.user_id
                        };
                        logins.push(login);
                        setStorage("logins", logins);

                        // Save device
                        setStorage("logins."+details.user_id, {
                            deviceToImport: exportedDevice,
                            baseUrl: url,
                            accessToken: details.access_token
                        });
                        if (callbacks.verificationCompleted) callbacks.verificationCompleted(login);
                    },2000);
                }
            });
        });        

        window.matrixHelper.client = client;
        await client.initCrypto();
        await client.startClient();
    }

    static async sendEncryptedToEveryone(client){
        // Ensure crypto is enabled
        await client.initCrypto();

        // Everyone is known and verified
        client.on('Room.timeline', async (message, room, toStartOfTimeline) => {
            // STUB: Don't do this all the time!
            await client.exportRoomKeys();    
            const e2eMembers = await room.getEncryptionTargetMembers();
            for (const member of e2eMembers) {
                const devices = client.getStoredDevicesForUser(member.userId);
                for (const device of devices) {
                    if (!device.known) await client.setDeviceKnown(member.userId, device.deviceId, true);
                    if (!device.verified) await client.setDeviceVerified(member.userId, device.deviceId, true);
                }
            }    
        });        
    }
    
    static async rememberAccount(){
        
    }
}

window.matrixHelper = MatrixHelper;



</script>
                
            </wpm-package>            
            <wpm-package id="potpack">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Potpack library",
    "dependencies": [
    ],
    "assets": [],
    "version": "1.0.1",
    "changelog": {},
    "license": "ISC",
    "documentationLink": "https://github.com/mapbox/potpack"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/potpack@1.0.1/index.min.js");
                </script>
            </wpm-package>
            <wpm-package id="js-yaml">
                <script id="descriptor-script" type="descriptor">
{
    "description": "This is an implementation of YAML, a human-friendly data serialization language. Started as PyYAML port, it was completely rewritten from scratch. Now it's very fast, and supports 1.2 spec.",
    "dependencies": [],
    "assets": [],
    "version": "4.1.0",
    "license": "MIT",
    "documentationLink": "https://github.com/nodeca/js-yaml"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js");
                </script>
            </wpm-package>       
            <wpm-package id="UUIDGenerator">
                <script id="descriptor-script" type="descriptor">
{
    "description": "An UUID generator",
    "dependencies": [],
    "assets": [],
    "version": "1.0",
    "license": "Apache 2.0",
    "changelog": {
        "1.0": "Initial version"
    }
}

</script>

                <script id="generator-script" type="disabled">
/**
 *  UUIDGenerator
 *  Provides unqiue IDs
 * 
 *  Copyright 2020, 2021 Rolf Bagge, Janus B. Kristensen, CAVI,
 *  Center for Advanced Visualization and Interacion, Aarhus University
 *    
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0

 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
**/

window.UUIDGenerator = class UUIDGenerator {
    /**
     * Generates a probably unique id
     * @param {string} prefix a prefix for the id
     * @param {number} length the length of the id
     * @returns {String} the generated id
     */
    static generateUUID(prefix = "", length = 20) {
        function dec2hex(dec) {
            return ('0' + dec.toString(16)).substr(-2);
        }

        let arr = new Uint8Array((length || 40) / 2);
        window.crypto.getRandomValues(arr);
        return prefix + Array.from(arr, dec2hex).join('');
    }
};

</script>

            </wpm-package>
            <wpm-package id="KeyboardHelper">
                <script id="descriptor-script" type="descriptor">
{
  "description": "A tiny helper to make keyboard shortcuts easier",
  "dependencies": [
  ],
  "assets": [],
  "version": "0.1",
  "changelog": {
    "0.1": "Initial version"
  }
}

</script>

                <script id="shortkeys-script" type="disabled">
window.KeyboardHelper = class KeyboardHelper {
    static checkKeyCombo(combo, event){
        if (typeof combo.modifiers !== "undefined" && combo.modifiers instanceof Array){
            if (combo.modifiers.includes("shift") && !event.shiftKey) return false;
            if (combo.modifiers.includes("ctrl") && !event.ctrlKey) return false;
            if (combo.modifiers.includes("alt") && !event.altKey) return false;
            if (combo.modifiers.includes("meta") && !event.metaKey) return false;
        }
        let eventTypes = combo.events;
        //If no eventtypes defines, default to "keyup"
        if (typeof eventTypes === "undefined") {
            eventTypes = ["keyup"];
        }
        if (!eventTypes.includes(event.type)) return false;
        return combo.key === event.code;
    }
}

</script>

            </wpm-package>
            <wpm-package id="WebstratePackageManagerUIHelper">
                <script id="descriptor-script" type="descriptor">
{
    "description": "Helps create UIs based on metadata from WebstratePackageManager packages",
    "dependencies": [
        "#cQuery"
    ],
    "assets": [],
    "version": "0.1",
    "changelog": {
        "0.1": "Initial version"
    }
}

</script>

                <script id="wpm_ui_helper-script" type="disabled">
window.WebstratePackageManagerUIHelper = class WebstratePackageManagerUIHelper {
    static async buildPackageListView(repositories, config={}) {
        if (typeof config.packageEntryView === "undefined"){
            config.packageEntryView = function(thePackage){return WebstratePackageManagerUIHelper.buildCompactPackageView(thePackage)};
        }
        if (typeof config.packageHeaderView === "undefined"){
            config.packageHeaderView = function(thePackage){return WebstratePackageManagerUIHelper.buildCompactHeaderView()};
        }        
        if (typeof config.packageFilter === "undefined"){
            config.packageFilter = function(thePackage){return true;};
        }        

        let view = cQuery("<div class='wpm_ui_helper_list'></div>");
        view[0].repositories = repositories;
        view[0].config = config;
        view.append(config.packageHeaderView());
                
        // Get already installed packages
        let packagesLeftToShow = [];
        if (typeof config.showAllPackages === "undefined" || config.showAllPackages===true){
            packagesLeftToShow = packagesLeftToShow.concat(await WPMv2.getCurrentlyInstalledPackages());
        }

        // Get packages from requested repositories        
        for (let i=0; i<repositories.length; i++){
            let packages = await WPMv2.getPackagesFromRepository(repositories[i]);
            for (let o=0; o<packages.length; o++){
                if (config.packageFilter(packages[o])){
                    // Build the view
                    let packageView = config.packageEntryView(packages[o]);
                    view.append(packageView);
                    
                    // Remove it from list of packages to show
                    packagesLeftToShow = packagesLeftToShow.filter(function(repositoryPackage){
                        return repositoryPackage.name!==packages[o].name;
                    });
                }
            }
        }
        // Packages from other repositories must fetch update info directly
        for (let i=0; i<packagesLeftToShow.length; i++){
            if (config.packageFilter(packagesLeftToShow[i])){
                let newPackage = await WPMv2.getLatestPackageFromPackage(packagesLeftToShow[i]);
                view.append(config.packageEntryView(newPackage));
            }
        }

        return view;
    }
    
    static buildCompactHeaderView(config={}){    
        return cQuery(`<div class='wpm_ui_helper_package_header wpm_ui_helper_compact'>
                <span class='wpm_ui_helper_packagename'>Package</span>
                <span class='wpm_ui_helper_packageversion'>Repos.</span>
                <span class='wpm_ui_helper_installedversion'>Here</span>
                <button class='wpm_ui_helper_action'>Update All</button></div>`);
    }
    
    static buildCompactPackageView(thePackage, config={}){
        let self = this;
        let packageContainer = cQuery("<div class='wpm_ui_helper_package wpm_ui_helper_compact'></div>");

        if (typeof config.onPackageInstalled==="undefined"){
            config.onPackageInstalled = function(){};
        }
        if (typeof config.onPackageSelection==="undefined"){
            config.onPackageSelection = function(aPackage){
                if (aPackage.name===thePackage.name){
                    cQuery(".wpm_ui_helper_selected").removeClass("wpm_ui_helper_selected");
                    packageContainer.addClass("wpm_ui_helper_selected");
                }
            }
        }
        packageContainer.on("click", function(){config.onPackageSelection(thePackage)});
        
        // Fetch metadata for potentially installed package
        let metaData = wpm.readMetadata(thePackage.name);
        if (metaData){
            packageContainer.addClass("wpm_ui_helper_installed");
        }
        
        if(cQuery(".packages transient .package#"+thePackage.name).length > 0) {
            packageContainer.addClass("wpm_ui_helper_transient");
        }
       
        if (thePackage.friendlyName){
            packageContainer.append("<span class='wpm_ui_helper_friendlyname'>"+thePackage.friendlyName+"</span>");
        } else {            
            packageContainer.append("<span class='wpm_ui_helper_friendlyname'>"+thePackage.name+"</span>");
        }
        packageContainer.append("<span class='wpm_ui_helper_packagename'>"+thePackage.name+"</span>");
        packageContainer.append("<span class='wpm_ui_helper_packageversion'>"+thePackage.version+"</span>");
        packageContainer.append("<span class='wpm_ui_helper_installedversion'>"+(metaData && metaData.version?metaData.version:"")+"</span>");
        
        if (thePackage.description){
            packageContainer.append("<span class='wpm_ui_helper_description'>"+thePackage.description+"</span>");
        }
        
        if (thePackage.documentationLink){
            packageContainer.append("<span class='wpm_ui_helper_documentationlink'><a href=\""+thePackage.documentationLink+"\" target=\"_blank\">Read More</a></span>");
        }
        
        if (thePackage.changelog && Object.keys(thePackage.changelog).length>0){
            let changeLog = cQuery("<div class='wpm_ui_helper_changelog'><div class='cl_header'>Recent Changes</div></div>");

            // TODO : Iterate log
            for (let version in thePackage.changelog){
                changeLog.append("<div class='wpm_ui_helper_changeentry'><div class='wpm_ui_helper_cle_head'>"+version+"</div>"+thePackage.changelog[version]+"</div>");
            }
            

            packageContainer.append(changeLog);
        }
                        
        
        if (config.showStateAsButton || typeof config.showStateAsButton==="undefined"){
            let button = cQuery("<button class='wpm_ui_helper_action'></button>");
            packageContainer.append(button);
            
            button.on("click", function(e){
                packageContainer.addClass("wpm_ui_helper_busy");
                let work = cQuery(this).data("work");
                e.stopPropagation();                
                work();
            });

            //Setup install/update work
            button.data("work", function() {
                return new Promise(function(resolve, reject) {
                    /*
                     * TODO: Reimplement install, maybee as require into head without static?
                     * 
                    WPMv2.require([thePackage]).then(function(){
                        config.onPackageInstalled(thePackage);
                        resolve();
                    });
                     */
                });
            });
            
            if (metaData){
                if (metaData.version!==thePackage.version){
                    button[0].innerText = "Update";
                } else {
                    button[0].innerText = "Remove";
                    
                    //Override work with remove
                    button.data("work", async function() {
                        /*
                         * TODO: Reimplement remove
                         * 
                        // Check dependency graph          
                        let dependencyChecks = [];
                        let dependingPackages = [];
                        let currentlyInstalledPackages = await WPMv2.getCurrentlyInstalledPackages();
                        
                        for(let p of currentlyInstalledPackages) {
                            let dependencyResult = await wpm.findNeededDependencies([p]);
                            if (dependencyResult.some(function(dependency){
                                return thePackage.name===dependency.name;
                            })){
                                dependingPackages.push(p);
                            }
                        }
                        
                        if (dependingPackages.length > 0){                                
                            if (confirm("Are you sure? This will also remove:\n"+dependingPackages.join("\n"))){
                                wpm.removePackages(dependingPackages);
                                wpm.removePackages([thePackage]);
                            }
                        } else {
                            wpm.removePackages([thePackage]);
                        }
                        */
                    });
                }
            } else {
                button[0].innerText = "Install";
            }
        } else {
            if (metaData){
                packageContainer.append("<span>Installed</span>");
            }
        }
        packageContainer.append("<div class='wpm_ui_helper_clearfix'></div>");
        return packageContainer;
    }
};

webstrate.on("loaded", function() {
    var updateAll = function(){
        cQuery(".wpm_ui_helper_list").forEach(function(view) {
            let before = view.nextSibling;
            let parent = view.parentNode;
            let repositories = view.repositories;
            let config = view.config;
            WebstratePackageManagerUIHelper.buildPackageListView(repositories, config).then(function(newView){
                parent.insertBefore(newView[0], before);
                view.remove();                
            });
        });
    };    
    
    /*
     * TODO: Add these types of events to WPMv2
     * 
    // Register update callbacks
    let wpm = new WebstratePackageManager();
    wpm.registerInstalledPackagesCallback(updateAll);
    wpm.registerRemovedPackagesCallback(updateAll);    
     */
});

</script>

                <style id="base-style">
.wpm_ui_helper_list {
  display: block;
  width: 100%; }
  .wpm_ui_helper_list .wpm_ui_helper_clearfix {
    clear: both; }
  .wpm_ui_helper_list .wpm_ui_helper_package, .wpm_ui_helper_list .wpm_ui_helper_package_header {
    display: flex;
    position: relative;
    flex-direction: row;
    word-wrap: break-word;
    padding: 0.5em;
    background: rgba(100, 100, 150, 0.05); }
    .wpm_ui_helper_list .wpm_ui_helper_package:nth-child(2n), .wpm_ui_helper_list .wpm_ui_helper_package_header:nth-child(2n) {
      background: rgba(100, 100, 150, 0.1); }
    .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_packageversion, .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_installedversion, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_packageversion, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_installedversion {
      width: 4em; }
      .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_packageversion:empty:before, .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_installedversion:empty:before, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_packageversion:empty:before, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_installedversion:empty:before {
        content: "-"; }
    .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_action, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_action {
      width: 10em; }
    .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_friendlyname ~ .wpm_ui_helper_packagename, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_friendlyname ~ .wpm_ui_helper_packagename {
      display: none; }
    .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_packagename, .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_friendlyname, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_packagename, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_friendlyname {
      min-width: 3em;
      word-wrap: break-word;
      flex-grow: 1; }
    .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_description, .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_changelog, .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_documentationlink, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_description, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_changelog, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_documentationlink {
      display: none; }
    .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_changelog, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_changelog {
      opacity: 0.6;
      font-size: 0.9em;
      font-style: italic;
      max-height: 10em;
      overflow-y: auto; }
      .wpm_ui_helper_list .wpm_ui_helper_package .wpm_ui_helper_changelog .wpm_ui_helper_cle_head, .wpm_ui_helper_list .wpm_ui_helper_package_header .wpm_ui_helper_changelog .wpm_ui_helper_cle_head {
        float: left;
        font-weight: bold;
        margin-right: 1em; }
    .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_busy, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_busy {
      opacity: 0.5; }
    .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_installed > :first-child, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_installed > :first-child {
      font-weight: bold; }
    .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_transient > :first-child:after, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_transient > :first-child:after {
      content: " [transient]"; }
    .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected {
      display: block;
      padding-left: 1em; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected:before, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected:before {
        /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#1e5799+0,7db9e8+100&1+0,0+100;Blue+to+Transparent */
        background: -moz-linear-gradient(left, #1e5799 0%, rgba(125, 185, 232, 0) 100%);
        /* FF3.6-15 */
        background: -webkit-linear-gradient(left, #1e5799 0%, rgba(125, 185, 232, 0) 100%);
        /* Chrome10-25,Safari5.1-6 */
        background: linear-gradient(to right, #1e5799 0%, rgba(125, 185, 232, 0) 100%);
        /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#1e5799', endColorstr='#007db9e8',GradientType=1 );
        /* IE6-9 */
        position: absolute;
        opacity: 0.1;
        left: 0;
        width: 1em;
        height: 100%;
        top: 0;
        content: ""; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_packagename, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_packagename {
        display: block;
        padding-right: 10em;
        /* action space */ }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_friendlyname ~ .wpm_ui_helper_packagename, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_friendlyname ~ .wpm_ui_helper_packagename {
        display: block;
        font-size: 0.8em;
        opacity: 0.8;
        padding-top: 0; }
        .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_friendlyname ~ .wpm_ui_helper_packagename:before, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_friendlyname ~ .wpm_ui_helper_packagename:before {
          content: "#"; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_action, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_action {
        position: absolute;
        top: 0;
        margin: 0.5em;
        right: 0; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_description, .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_changelog, .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_documentationlink, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_description, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_changelog, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_documentationlink {
        display: block;
        margin-top: 0.5em; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_packageversion:before, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_packageversion:before {
        content: "Repository Version: "; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_installedversion:before, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_installedversion:before {
        content: "Installed Version: "; }
      .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_packageversion, .wpm_ui_helper_list .wpm_ui_helper_package.wpm_ui_helper_selected .wpm_ui_helper_installedversion, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_packageversion, .wpm_ui_helper_list .wpm_ui_helper_package_header.wpm_ui_helper_selected .wpm_ui_helper_installedversion {
        width: 30%;
        float: right;
        clear: right;
        text-align: right;
        font-size: 0.9em; }
  .wpm_ui_helper_list .wpm_ui_helper_package_header {
    background: rgba(100, 100, 150, 0.15);
    font-weight: bold;
    border-bottom: 1px solid grey; }
</style>

            </wpm-package>
            <wpm-package id="oscjs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "osc.js",
    "dependencies": [
    ],
    "assets": [],
    "version": "2.3.2",
    "license": "MIT",
    "documentationLink": "https://github.com/adzialocha/osc-js/"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/osc-js@2.3.2/lib/osc.min.js");
                </script>
            </wpm-package>
            <wpm-package id="uPlot">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A small, fast chart for time series, lines, areas, ohlc & bars",
    "dependencies": [],
    "assets": [],
    "version": "1.6.22",
    "changelog": {
        "1.6.22": "Initial version"
    },
    "license": "MIT",
    "documentationLink": "https://github.com/leeoniya/uPlot"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/uplot@1.6.22/dist/uPlot.iife.min.js");
                </script>
            </wpm-package>
            <wpm-package id="chrono">
                <script id="descriptor-script" type="descriptor">
{
    "description": "A natural language date parser in Javascript, designed for extracting date information from any given text.",
    "dependencies": [],
    "assets": [],
    "version": "1.4.8",
    "changelog": {
        "1.4.8": "Initial version"
    },
    "documentationLink": "",
    "license": "MIT"
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdn.jsdelivr.net/npm/chrono-node@1.4.8/dist/chrono.min.js");
                </script>
            </wpm-package>
            <wpm-package id="svgjs">
                <script id="descriptor-script" type="descriptor">
{
    "description": "The lightweight library for manipulating and animating SVG.",
    "dependencies": [],
    "assets": [],
    "version": "3.1.2",
    "license": "MIT",
    "changelog": {
        "3.1.2": "Initial version"
    }
}

</script>

                <script type="disabled">
                    await wpm.requireExternal("https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.1.2/svg.min.js");
                </script>
            </wpm-package>
            <wpm-package id="finder">
                <script id="descriptor-script" type="descriptor">
{
    "description": "CSS Selector Generator",
    "dependencies": [
    ],
    "assets": [],
    "license": "MIT",
    "version": "2.1.0",
    "documentationLink": "https://github.com/antonmedv/finder"
}

</script>

                <script type="disabled">
                    window.finder = (await import("https://medv.io/finder/finder.js")).finder;
                </script>
            </wpm-package>
        </div>
    </body>
</html> 

